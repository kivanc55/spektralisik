<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <title>Otonom Aydınlatma Sistemi - Mavi Filtre Simülasyonu</title>
    <style>
        body { 
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; 
            display: flex; 
            flex-direction: column; 
            align-items: center; 
            background: #f4f4f9; 
            padding: 20px;
            color: #333;
        }
        .main-container { 
            background: white; 
            padding: 30px; 
            border-radius: 25px; 
            box-shadow: 0 15px 40px rgba(0,0,0,0.1); 
            width: 900px; 
            text-align: center;
        }
        
        .simulation-row {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin: 20px 0;
            gap: 20px;
        }

        .side-panel {
            flex: 1;
            padding: 20px;
            border-radius: 15px;
            background: #fafafa;
            border: 1px solid #eee;
            display: flex;
            flex-direction: column;
            justify-content: center;
            min-height: 250px;
        }

        .data-label { font-size: 16px; color: #666; font-weight: 600; margin-bottom: 5px; }
        .data-value { font-size: 48px; font-weight: 800; color: #222; }
        .unit { font-size: 18px; color: #888; }

        .scene { 
            width: 450px; 
            height: 300px; 
            border: 4px solid #333; 
            border-radius: 20px; 
            position: relative; 
            overflow: hidden; 
            background: #111; 
            transition: background 0.1s; /* Daha hızlı tepki için düşürüldü */
            box-shadow: inset 0 0 50px rgba(0,0,0,0.5);
        }

        .sun {
            position: absolute;
            top: 20px;
            right: 20px;
            width: 70px;
            height: 70px;
            background: radial-gradient(circle, #fff700 30%, #ffaa00 100%);
            border-radius: 50%;
            box-shadow: 0 0 60px #fff700;
            transition: opacity 0.3s, transform 0.3s;
        }

        .sensor-unit {
            position: absolute;
            bottom: 40px;
            left: 40px;
            text-align: center;
        }
        .ldr {
            width: 50px;
            height: 25px;
            background: #444;
            border-radius: 5px;
            margin: 0 auto;
            position: relative;
            border: 2px solid #222;
        }

        .blue-filter {
            position: absolute;
            top: -8px;
            left: -8px;
            width: 66px;
            height: 41px;
            background: rgba(0, 150, 255, 0.4);
            border: 2px solid rgba(0, 191, 255, 0.7);
            border-radius: 4px;
            backdrop-filter: blur(1.5px);
            box-shadow: 0 0 10px rgba(0, 150, 255, 0.3);
        }

        .led-unit {
            position: absolute;
            bottom: 40px;
            right: 40px;
            text-align: center;
        }
        .led-bulb {
            width: 60px;
            height: 60px;
            background: #333;
            border-radius: 50% 50% 20% 20%;
            margin: 0 auto;
            transition: all 0.1s;
            border: 2px solid #222;
        }

        .label-tag { font-size: 11px; color: #ddd; background: rgba(0,0,0,0.6); padding: 3px 8px; border-radius: 10px; margin-top: 8px; display: inline-block; }

        .controls { 
            margin-top: 20px; 
            padding: 20px; 
            background: #eee; 
            border-radius: 15px; 
        }
        input[type=range] { width: 100%; height: 10px; cursor: pointer; }
        
        #savingBox { margin-top: 15px; }
        .saving-text { font-size: 32px; font-weight: 800; }
    </style>
</head>
<body>

<div class="main-container">
    <h2 style="margin-bottom:10px;">Otonom Aydınlatma Sistemi</h2>
    <p style="color:#777; margin-bottom:20px;">Hibrid Aydınlık Dengesi: Güneş + LED</p>
    
    <div class="simulation-row">
        <div class="side-panel">
            <div class="data-label">LDR DEĞERİ (GÜN IŞIĞI)</div>
            <div class="data-value" id="adcVal">0</div>
            <div class="unit">ADC (0-1023)</div>
        </div>

        <div class="scene" id="scene">
            <div class="sun" id="sun"></div>
            
            <div class="sensor-unit">
                <div class="ldr">
                    <div class="blue-filter"></div>
                </div>
                <span class="label-tag">Mavi Filtreli LDR</span>
            </div>

            <div class="led-unit">
                <div class="led-bulb" id="led"></div>
                <span class="label-tag">Sarı LED Modülü</span>
            </div>
        </div>

        <div class="side-panel">
            <div style="margin-bottom: 30px;">
                <div class="data-label">LED ÇIKIŞI</div>
                <div class="data-value" id="pwmVal" style="color: #fbc02d;">255</div>
                <div class="unit">PWM (0-255)</div>
            </div>
            <div id="savingBox">
                <div class="data-label">ENERJİ TASARRUFU</div>
                <div class="saving-text" id="savingVal" style="color: #d32f2f;">%0</div>
            </div>
        </div>
    </div>

    <div class="controls">
        <label style="font-weight: bold; display: block; margin-bottom: 10px;">DIŞ ORTAM IŞIK ŞİDDETİ (Simüle Edilen)</label>
        <input type="range" id="lightSlider" min="0" max="1023" value="0">
        <div style="display: flex; justify-content: space-between; font-size: 13px; color: #555; margin-top: 5px;">
            <span>ZİFİRİ KARANLIK</span>
            <span>TAM GÜNEŞLİ</span>
        </div>
    </div>
</div>

<script>
    const slider = document.getElementById('lightSlider');
    const sun = document.getElementById('sun');
    const scene = document.getElementById('scene');
    const led = document.getElementById('led');
    const adcDisplay = document.getElementById('adcVal');
    const pwmDisplay = document.getElementById('pwmVal');
    const savingDisplay = document.getElementById('savingVal');

    // LDR Eşik Değerleri
    const minADC = 100; 
    const maxADC = 800; 

    slider.addEventListener('input', () => {
        const val = parseInt(slider.value);
        adcDisplay.innerText = val;

        // 1. GÜNEŞ EFEKTİ HESAPLAMA
        const sunIntensity = val / 1023;
        sun.style.opacity = sunIntensity;
        sun.style.transform = `scale(${0.6 + (sunIntensity * 0.4)})`;
        
        // 2. PWM (LED GÜCÜ) HESAPLAMA
        let pwm = 0;
        if (val >= maxADC) {
            pwm = 0; 
        } else if (val <= minADC) {
            pwm = 255; 
        } else {
            pwm = Math.round(255 - ((val - minADC) * 255 / (maxADC - minADC)));
        }
        pwmDisplay.innerText = pwm;

        // 3. LED GÖRSEL PARLAKLIĞI
        const ledPower = pwm / 255;
        if (pwm > 0) {
            led.style.backgroundColor = "#ffeb3b";
            led.style.boxShadow = `0 0 ${20 + (ledPower * 60)}px #ffeb3b, inset 0 0 15px white`;
            led.style.opacity = 0.5 + (ledPower * 0.5);
        } else {
            led.style.backgroundColor = "#333";
            led.style.boxShadow = "none";
            led.style.opacity = 1;
        }

        // 4. HİBRİD ORTAM AYDINLIĞI (DENGELEME MANTIĞI)
        // Güneşten ve LED'den gelen toplam lümen etkisini simüle ediyoruz
        const ambientFromSun = (val / 1023) * 180; // Güneşin odaya katkısı
        const ambientFromLed = (pwm / 255) * 100;  // LED'in odaya katkısı
        
        // Toplam aydınlık: Gece bile LED sayesinde oda belli bir seviyede aydınlık kalır
        const baseBrightness = 50; // Zifiri karanlıkta bile minimum görünebilirlik
        const totalBrightness = Math.min(245, baseBrightness + ambientFromSun + ambientFromLed);
        
        // Arka plan rengini (RGB) toplam aydınlığa göre ayarla
        scene.style.backgroundColor = `rgb(${totalBrightness}, ${totalBrightness}, ${totalBrightness + 10})`;

        // 5. TASARRUF GÖSTERGESİ
        const saving = Math.round((1 - (pwm / 255)) * 100);
        savingDisplay.innerText = `%${saving}`;
        
        if (saving >= 90) {
            savingDisplay.style.color = "#2e7d32"; 
        } else if (saving >= 40) {
            savingDisplay.style.color = "#f57c00"; 
        } else {
            savingDisplay.style.color = "#d32f2f"; 
        }
    });

    // Başlangıç tetiklemesi
    slider.dispatchEvent(new Event('input'));
</script>

</body>
</html>